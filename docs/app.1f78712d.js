var e=globalThis,t={},o={},r=e.parcelRequire94c2;null==r&&((r=function(e){if(e in t)return t[e].exports;if(e in o){var r=o[e];delete o[e];var n={id:e,exports:{}};return t[e]=n,r.call(n.exports,n,n.exports),n.exports}var i=Error("Cannot find module '"+e+"'");throw i.code="MODULE_NOT_FOUND",i}).register=function(e,t){o[e]=t},e.parcelRequire94c2=r);var n=r.register;n("27Lyk",function(e,t){Object.defineProperty(e.exports,"register",{get:()=>o,set:e=>o=e,enumerable:!0,configurable:!0});var o,r=new Map;o=function(e,t){for(var o=0;o<t.length-1;o+=2)r.set(t[o],{baseUrl:e,path:t[o+1]})}}),n("lKpmK",function(e,t){e.exports=new URL("service-worker.08de97fb.js",import.meta.url).toString()}),r("27Lyk").register(new URL("",import.meta.url).toString(),JSON.parse('["aVCRy","app.1f78712d.js","3o9Aw","service-worker.08de97fb.js"]'));var i=r("8XP4m"),s=r("1zsFO"),a=r("hRA4F");const d=new URL(r("lKpmK"));"serviceWorker"in navigator&&navigator.serviceWorker.register(d.href,{scope:"/codex/"}).then(()=>console.log("Service Worker Registered for scope:",d.href,"with","file:///assets/scripts/app.js")).catch(e=>console.error("Service Worker Error:",e));const l=[];var c="asc";function m(e){let t=document.getElementById("book-list"),o=document.getElementById("no-books");if(t.innerHTML="",0===e.length){o.classList.add("show"),o.classList.remove("hide");return}o.classList.remove("show"),o.classList.add("hide"),e.forEach(e=>{var o;let r=document.createElement("article");if(r.id=e.id,r.classList.add("book-card"),r.setAttribute("aria-labelledby",`book-title-${e.id}`),r.tabIndex=0,""!==e.cover){let t=document.createElement("div");t.classList.add("book-img");let o=document.createElement("img");o.src=e.cover,o.alt=`${e.title} Book Cover`,t.appendChild(o),r.appendChild(t)}let n=document.createElement("div");n.classList.add("book-info");let i=document.createElement("h2");i.id=`book-title-${e.id}`,i.textContent=e.title;let s=document.createElement("p");s.innerHTML=`<strong>Author:</strong> ${e.author}`;let a=document.createElement("p");a.innerHTML=`<strong>Genre:</strong> ${e.genre.join(", ")}`;let d=document.createElement("p");d.innerHTML=`<strong>Status:</strong> ${e.status}`;let l=document.createElement("p");l.innerHTML=`<strong>Progress:</strong> ${e.progress}%`;let c=document.createElement("span");c.classList.add("book-rating"),c.setAttribute("aria-label",`Rating: ${e.rating} out of 5 stars`),c.innerHTML=(o=e.rating,"&starf;".repeat(o)),n.appendChild(i),n.appendChild(s),n.appendChild(a),n.appendChild(d),n.appendChild(l),r.appendChild(n),r.appendChild(c),t.appendChild(r)})}function u(e){e&&(e.classList.add("highlight"),e.focus(),e.scrollIntoView({behavior:"smooth"}),setTimeout(()=>e.classList.remove("highlight"),1e3))}document.addEventListener("DOMContentLoaded",async()=>{let e=document.getElementById("book-list"),t=document.getElementById("book-form"),o=document.getElementById("book-management-form"),r=document.getElementById("close-form"),n=document.getElementById("delete-book"),d=document.getElementById("book-id");await new Promise((e,t)=>{(0,i.auth).onAuthStateChanged(o=>{o?e(o):(console.log("User is not authenticated"),window.location="index.html",t("User not authenticated"))})}),await (0,i.getBooksFromFirestore)(l);let g=null;e.addEventListener("keydown",t=>{if("ArrowDown"===t.key){if(t.preventDefault(),null===g)g=e.querySelector(".book-card");else{let e=g.nextElementSibling;e&&e.classList.contains("book-card")&&(g=e)}u(g)}else if("ArrowUp"===t.key){if(t.preventDefault(),null===g)g=e.querySelector(".book-card");else{let e=g.previousElementSibling;e&&e.classList.contains("book-card")&&(g=e)}u(g)}else if(("Enter"===t.key||" "===t.key)&&(t.preventDefault(),g)){let e=g.id,t=l.find(t=>t.id==e);(0,s.openBookForm)(t)}}),e.addEventListener("focusin",e=>{e.target&&e.target.classList.contains("book-card")&&(g=e.target)}),e.addEventListener("click",e=>{let t=e.target.closest(".book-card");if(t){let e=t.id,o=l.find(t=>t.id==e);(0,s.openBookForm)(o)}}),o.addEventListener("submit",async o=>{let r;o.preventDefault();let n=o.target;if(!n.checkValidity()){n.reportValidity();return}let a=(0,s.sanitizeInput)(document.getElementById("book-cover").value.trim()),c=(0,s.sanitizeInput)(document.getElementById("book-title").value.trim()),u=(0,s.sanitizeInput)(document.getElementById("book-author").value.trim()),g=document.getElementById("book-genre").value.split(",").map(e=>(0,s.sanitizeInput)(e.trim())),p=(0,s.sanitizeInput)(document.getElementById("book-progress").value.trim()),v=(0,s.sanitizeInput)(document.getElementById("book-status").value.trim()),h=(0,s.sanitizeInput)(document.getElementById("book-rating").value.trim());if(""!==d.value){let e=l.findIndex(e=>e.id==d.value);if(-1!==e){l[e]={id:d.value,cover:a,title:c,author:u,genre:g,progress:p,status:v,rating:h};try{await (0,i.updateBookInFirestore)(l[e])}catch(e){console.error("Error updating book in Firestore: ",e)}r=l[e]}}else{let e={cover:a,title:c,author:u,genre:g,progress:p,status:v,rating:h};l.push(e);try{l[l.length-1].id=await (0,i.addBookToFirestore)(e)}catch(e){console.error("Error adding book to Firestore: ",e)}r=e}m(l),t.classList.remove("show"),e.classList.remove("hide");let k=document.getElementById(r.id);k&&(k.classList.add("highlight"),k.focus(),k.scrollIntoView({behavior:"smooth"}),setTimeout(()=>k.classList.remove("highlight"),1500))}),r.addEventListener("click",()=>{t.classList.remove("show"),e.classList.remove("hide")}),n.addEventListener("click",function(){if(""!==d.value&&confirm(`Are you sure you want to delete the book "${document.getElementById("book-title").value}" entry?`)){let o=l.findIndex(e=>e.id==d.value);if(-1!==o){try{(0,i.removeBookFromFirestore)(d.value)}catch(e){console.error("Error removing book from Firestore: ",e)}l.splice(o,1)}m(l),t.classList.remove("show"),e.classList.remove("hide")}}),document.getElementById("order-by-title").addEventListener("click",()=>{c="asc"===c?"desc":"asc",m((0,s.orderBooksArrayBy)(l,"title",c)),(0,a.closeMenu)()}),document.getElementById("order-by-author").addEventListener("click",()=>{c="asc"===c?"desc":"asc",m((0,s.orderBooksArrayBy)(l,"author",c)),(0,a.closeMenu)()}),document.getElementById("order-by-progress").addEventListener("click",()=>{c="asc"===c?"desc":"asc",m((0,s.orderBooksArrayBy)(l,"progress",c)),(0,a.closeMenu)()}),document.getElementById("order-by-rating").addEventListener("click",()=>{c="asc"===c?"desc":"asc",m((0,s.orderBooksArrayBy)(l,"rating",c)),(0,a.closeMenu)()}),document.getElementById("add-first-book").addEventListener("click",()=>{let e=document.getElementById("no-books");e.classList.remove("show"),e.classList.add("hide"),(0,s.openBookForm)()}),m((0,s.orderBooksArrayBy)(l,"title",c))});
//# sourceMappingURL=app.1f78712d.js.map
