var e=globalThis,t={},o={},r=e.parcelRequire94c2;null==r&&((r=function(e){if(e in t)return t[e].exports;if(e in o){var r=o[e];delete o[e];var n={id:e,exports:{}};return t[e]=n,r.call(n.exports,n,n.exports),n.exports}var i=Error("Cannot find module '"+e+"'");throw i.code="MODULE_NOT_FOUND",i}).register=function(e,t){o[e]=t},e.parcelRequire94c2=r);var n=r.register;n("27Lyk",function(e,t){Object.defineProperty(e.exports,"register",{get:()=>o,set:e=>o=e,enumerable:!0,configurable:!0});var o,r=new Map;o=function(e,t){for(var o=0;o<t.length-1;o+=2)r.set(t[o],{baseUrl:e,path:t[o+1]})}}),n("lKpmK",function(e,t){e.exports=new URL("service-worker.48cfd86f.js",import.meta.url).toString()}),r("27Lyk").register(new URL("",import.meta.url).toString(),JSON.parse('["aVCRy","app.58e9697b.js","3o9Aw","service-worker.48cfd86f.js"]'));var i=r("8XP4m"),s=r("1zsFO"),a=r("hRA4F");const l=new URL(r("lKpmK"));function d(e){let t=document.getElementById("book-list");t.innerHTML="",e.forEach(e=>{var o;let r=document.createElement("article");if(r.id=e.id,r.classList.add("book-card"),r.setAttribute("aria-labelledby",`book-title-${e.id}`),r.tabIndex=0,""!==e.cover){let t=document.createElement("div");t.classList.add("book-img");let o=document.createElement("img");o.src=e.cover,o.alt=`${e.title} Book Cover`,t.appendChild(o),r.appendChild(t)}let n=document.createElement("div");n.classList.add("book-info");let i=document.createElement("h2");i.id=`book-title-${e.id}`,i.textContent=e.title;let s=document.createElement("p");s.innerHTML=`<strong>Author:</strong> ${e.author}`;let a=document.createElement("p");a.innerHTML=`<strong>Genre:</strong> ${e.genre.join(", ")}`;let l=document.createElement("p");l.innerHTML=`<strong>Status:</strong> ${e.status}`;let d=document.createElement("p");d.innerHTML=`<strong>Progress:</strong> ${e.progress}%`;let c=document.createElement("span");c.classList.add("book-rating"),c.setAttribute("aria-label",`Rating: ${e.rating} out of 5 stars`),c.innerHTML=(o=e.rating,"&starf;".repeat(o)+"&star;".repeat(5-o)),n.appendChild(i),n.appendChild(s),n.appendChild(a),n.appendChild(l),n.appendChild(d),r.appendChild(n),r.appendChild(c),t.appendChild(r)})}function c(e){e&&(e.classList.add("highlight"),e.focus(),e.scrollIntoView({behavior:"smooth"}),setTimeout(()=>e.classList.remove("highlight"),1e3))}"serviceWorker"in navigator&&navigator.serviceWorker.register(l.href,{scope:"/codex/"}).then(()=>console.log("Service Worker Registered for scope:",l.href,"with","file:///assets/scripts/app.js")).catch(e=>console.error("Service Worker Error:",e)),document.addEventListener("DOMContentLoaded",async()=>{let e=[],t="asc",o=document.getElementById("book-list"),r=document.getElementById("book-form"),n=document.getElementById("book-management-form"),l=document.getElementById("close-form"),u=document.getElementById("delete-book"),m=document.getElementById("book-id");await new Promise((e,t)=>{(0,i.auth).onAuthStateChanged(o=>{o?e(o):(console.log("User is not authenticated"),window.location="index.html",t("User not authenticated"))})}),await (0,i.getBooksFromFirestore)(e);let g=null;o.addEventListener("keydown",t=>{if("ArrowDown"===t.key){if(t.preventDefault(),null===g)g=o.querySelector(".book-card");else{let e=g.nextElementSibling;e&&e.classList.contains("book-card")&&(g=e)}c(g)}else if("ArrowUp"===t.key){if(t.preventDefault(),null===g)g=o.querySelector(".book-card");else{let e=g.previousElementSibling;e&&e.classList.contains("book-card")&&(g=e)}c(g)}else if(("Enter"===t.key||" "===t.key)&&(t.preventDefault(),g)){let t=g.id,o=e.find(e=>e.id==t);(0,s.openBookForm)(o)}}),o.addEventListener("focusin",e=>{e.target&&e.target.classList.contains("book-card")&&(g=e.target)}),o.addEventListener("click",t=>{let o=t.target.closest(".book-card");if(o){let t=o.id,r=e.find(e=>e.id==t);(0,s.openBookForm)(r)}}),n.addEventListener("submit",async t=>{let n;t.preventDefault();let a=t.target;if(!a.checkValidity()){a.reportValidity();return}let l=(0,s.sanitizeInput)(document.getElementById("book-cover").value.trim()),c=(0,s.sanitizeInput)(document.getElementById("book-title").value.trim()),u=(0,s.sanitizeInput)(document.getElementById("book-author").value.trim()),g=document.getElementById("book-genre").value.split(",").map(e=>(0,s.sanitizeInput)(e.trim())),p=(0,s.sanitizeInput)(document.getElementById("book-progress").value.trim()),v=(0,s.sanitizeInput)(document.getElementById("book-status").value.trim()),h=(0,s.sanitizeInput)(document.getElementById("book-rating").value.trim());if(""!==m.value){let t=e.findIndex(e=>e.id==m.value);if(-1!==t){e[t]={id:m.value,cover:l,title:c,author:u,genre:g,progress:p,status:v,rating:h};try{await (0,i.updateBookInFirestore)(e[t])}catch(e){console.error("Error updating book in Firestore: ",e)}n=e[t]}}else{let t={cover:l,title:c,author:u,genre:g,progress:p,status:v,rating:h};e.push(t);try{e[e.length-1].id=await (0,i.addBookToFirestore)(t)}catch(e){console.error("Error adding book to Firestore: ",e)}n=t}d(e),r.classList.remove("show"),o.classList.remove("hide");let k=document.getElementById(n.id);k&&(k.classList.add("highlight"),k.focus(),k.scrollIntoView({behavior:"smooth"}),setTimeout(()=>k.classList.remove("highlight"),1500))}),l.addEventListener("click",()=>{r.classList.remove("show"),o.classList.remove("hide")}),u.addEventListener("click",function(){if(""!==m.value&&confirm(`Are you sure you want to delete the book "${document.getElementById("book-title").value}" entry?`)){let t=e.findIndex(e=>e.id==m.value);if(-1!==t){try{(0,i.removeBookFromFirestore)(m.value)}catch(e){console.error("Error removing book from Firestore: ",e)}e.splice(t,1)}d(e),r.classList.remove("show"),o.classList.remove("hide")}}),document.getElementById("order-by-title").addEventListener("click",()=>{t="asc"===t?"desc":"asc",d((0,s.orderBooksArrayBy)(e,"title",t)),(0,a.closeMenu)()}),document.getElementById("order-by-author").addEventListener("click",()=>{t="asc"===t?"desc":"asc",d((0,s.orderBooksArrayBy)(e,"author",t)),(0,a.closeMenu)()}),document.getElementById("order-by-progress").addEventListener("click",()=>{t="asc"===t?"desc":"asc",d((0,s.orderBooksArrayBy)(e,"progress",t)),(0,a.closeMenu)()}),document.getElementById("order-by-rating").addEventListener("click",()=>{t="asc"===t?"desc":"asc",d((0,s.orderBooksArrayBy)(e,"rating",t)),(0,a.closeMenu)()}),d((0,s.orderBooksArrayBy)(e,"title",t))});
//# sourceMappingURL=app.58e9697b.js.map
